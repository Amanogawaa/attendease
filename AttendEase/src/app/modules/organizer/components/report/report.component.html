<main class="scroll-smooth w-full h-screen">
  <div class="p-4 mt-16 sm:ml-64">
    <button class="-ms-2" (click)="goBack()">
      <svg
        class="w-7 h-7 text-gray-800 dark:text-white"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        fill="none"
        viewBox="0 0 24 24"
      >
        <path
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="1"
          d="M5 12h14M5 12l4-4m-4 4 4 4"
        />
      </svg>
    </button>
    <div class="w-full flex justify-between items-center">
      <div>
        <p class="mt-5 mb-2 text-text text-2xl tracking-wide font-semibold">
          Event Report
        </p>
      </div>
    </div>
    <hr class="h-px mb-6 bg-dark-border border-0" />
    <div class="p-1.5 h-fit">
      <div>
        <div class="w-full flex flex-wrap">
          <div class="w-full flex items-center gap-1.5 p-2">
            <div class="w-1/2">
              <div class="w-full flex flex-col items-center gap-1.5">
                <div class="w-full">
                  <p-chart
                    *ngIf="
                      reportDetail.registered_users > 0 ||
                      reportDetail.present_count > 0 ||
                      reportDetail.feedback_count > 0
                    "
                    type="doughnut"
                    [data]="chartData"
                    [options]="chartOptions"
                  ></p-chart>
                  <div
                    *ngIf="
                      reportDetail.registered_users === 0 &&
                      reportDetail.present_count === 0 &&
                      reportDetail.feedback_count === 0
                    "
                    class="text-center"
                  >
                    <p>(￣ ￣|||)</p>
                    <span class="text-gray-500">No data available...</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="w-1/2">
              <div
                class="w-full p-4 bg-white border border-gray-200 rounded-lg shadow sm:p-6 dark:bg-gray-800 dark:border-gray-700"
              >
                <h5
                  class="mb-3 text-sm font-semibold text-gray-900 md:text-xl dark:text-white"
                >
                  Details
                </h5>
                <ul class="my-2">
                  <li>
                    <div
                      class="flex items-center p-1.5 text-sm font-bold text-gray-900"
                    >
                      <span class="flex-1 ms-3 whitespace-nowrap"> Name</span>
                      <span
                        class="inline-flex items-center justify-center px-2 py-0.5 ms-3 text-xs font-medium text-gray-500 bg-gray-200 rounded capitalize"
                        >{{ reportDetail.event_name }}</span
                      >
                    </div>
                  </li>

                  <li>
                    <div
                      class="flex items-center p-1.5 text-sm font-bold text-gray-900"
                    >
                      <span class="flex-1 ms-3 whitespace-nowrap"> Status</span>
                      <span
                        class="inline-flex items-center justify-center px-2 py-0.5 ms-3 text-xs font-medium text-gray-500 bg-gray-200 rounded capitalize"
                        >{{ reportDetail.event_status }}</span
                      >
                    </div>
                  </li>
                  <li>
                    <div
                      class="flex items-center p-1.5 text-sm font-bold text-gray-900"
                    >
                      <span class="flex-1 ms-3 whitespace-nowrap"> Date</span>
                      <span
                        class="inline-flex items-center justify-center px-2 py-0.5 ms-3 text-xs font-medium text-gray-500 bg-gray-200 rounded"
                        >{{ reportDetail.event_start_date | date : "longDate" }}
                        -
                        {{
                          reportDetail.event_end_date | date : "longDate"
                        }}</span
                      >
                    </div>
                  </li>
                  <li>
                    <div
                      class="flex items-center p-1.5 text-sm font-bold text-gray-900"
                    >
                      <span class="flex-1 ms-3 whitespace-nowrap">Time</span>
                      <span
                        class="inline-flex items-center justify-center px-2 py-0.5 ms-3 text-xs font-medium text-gray-500 bg-gray-200 rounded"
                        >{{
                          reportDetail.event_start_date | date : "shortTime"
                        }}
                        -
                        {{
                          reportDetail.event_end_date | date : "shortTime"
                        }}</span
                      >
                    </div>
                  </li>
                  <li>
                    <div
                      class="flex items-center p-1.5 text-sm font-bold text-gray-900"
                    >
                      <span class="flex-1 ms-3 whitespace-nowrap"
                        >Max Participants</span
                      >
                      <span
                        class="inline-flex items-center justify-center px-2 py-0.5 ms-3 text-xs font-medium text-gray-500 bg-gray-200 rounded"
                        >{{ reportDetail.max_attendees }}</span
                      >
                    </div>
                  </li>
                  <li>
                    <div
                      class="flex items-center p-1.5 text-sm font-bold text-gray-900"
                    >
                      <span class="flex-1 ms-3 whitespace-nowrap"
                        >Registered Participants</span
                      >
                      <span
                        class="inline-flex items-center justify-center px-2 py-0.5 ms-3 text-xs font-medium text-gray-500 bg-gray-200 rounded"
                        >{{ reportDetail.registered_users }}</span
                      >
                    </div>
                  </li>
                  <li>
                    <div
                      class="flex items-center p-1.5 text-sm font-bold text-gray-900"
                    >
                      <span class="flex-1 ms-3 whitespace-nowrap"
                        >Present Participants</span
                      >
                      <span
                        class="inline-flex items-center justify-center px-2 py-0.5 ms-3 text-xs font-medium text-gray-500 bg-gray-200 rounded"
                        >{{ reportDetail.present_count }}</span
                      >
                    </div>
                  </li>
                  <li>
                    <div
                      class="flex items-center p-1.5 text-sm font-bold text-gray-900"
                    >
                      <span class="flex-1 ms-3 whitespace-nowrap"
                        >Attendance Submitted</span
                      >
                      <span
                        class="inline-flex items-center justify-center px-2 py-0.5 ms-3 text-xs font-medium text-gray-500 bg-gray-200 rounded"
                        >{{ reportDetail.attendance_count }}</span
                      >
                    </div>
                  </li>
                  <li>
                    <div
                      class="flex items-center p-1.5 text-sm font-bold text-gray-900"
                    >
                      <span class="flex-1 ms-3 whitespace-nowrap"
                        >Feedback Submitted</span
                      >
                      <span
                        class="inline-flex items-center justify-center px-2 py-0.5 ms-3 text-xs font-medium text-gray-500 bg-gray-200 rounded"
                        >{{ reportDetail.feedback_count }}</span
                      >
                    </div>
                  </li>
                  <li>
                    <div
                      class="flex items-center p-1.5 text-sm font-bold text-gray-900"
                    >
                      <span class="flex-1 ms-3 whitespace-nowrap"
                        >Satisfaction Rating</span
                      >
                      <span
                        *ngIf="reportDetail.average_feedback !== 0"
                        class="inline-flex items-center justify-center px-2 py-0.5 ms-3 text-xs font-medium text-gray-500 bg-gray-200 rounded"
                      >
                        {{ reportDetail.average_feedback | number : "1.1" }}
                      </span>
                      <span
                        *ngIf="reportDetail.average_feedback === null"
                        class="inline-flex items-center justify-center px-2 py-0.5 ms-3 text-xs font-medium text-gray-500 bg-gray-200 rounded"
                      >
                        0
                      </span>
                    </div>
                  </li>

                  <!-- Iterate over student_details -->

                  <!-- End of iteration over student_details -->
                </ul>
                <button
                  type="button"
                  (click)="toggleDrawer()"
                  aria-expanded="false"
                  class="text-white bg-light-background hover:bg-light-foregroud focus:outline-none focus:ring-0 font-medium rounded-md text-sm px-3 py-2.5 me-2 mt-5 mb-2"
                >
                  Students List
                </button>
                <div
                  [ngClass]="{
                    'translate-x-full': !isDrawerVisible,
                    'translate-x-0': isDrawerVisible
                  }"
                  id="drawer-disable-body-scrolling"
                  class="fixed top-0 border-l border-dark-border right-0 z-50 h-screen p-4 overflow-y-auto transition-transform translate-x-full bg-white max-w-xl w-full dark:bg-gray-800"
                  tabindex="-1"
                >
                  <h5
                    id="drawer-label"
                    class="inline-flex items-center mb-4 text-base font-semibold text-gray-500 dark:text-gray-400"
                  >
                    <svg
                      class="w-6 h-6 text-gray-800 dark:text-white"
                      aria-hidden="true"
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      fill="none"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-width="2"
                        d="M4.5 17H4a1 1 0 0 1-1-1 3 3 0 0 1 3-3h1m0-3.05A2.5 2.5 0 1 1 9 5.5M19.5 17h.5a1 1 0 0 0 1-1 3 3 0 0 0-3-3h-1m0-3.05a2.5 2.5 0 1 0-2-4.45m.5 13.5h-7a1 1 0 0 1-1-1 3 3 0 0 1 3-3h3a3 3 0 0 1 3 3 1 1 0 0 1-1 1Zm-1-9.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0Z"
                      />
                    </svg>
                    Registered students in
                    <span class="text-light-text ms-1 capitalize"
                      >{{ reportDetail.event_name }}
                    </span>
                  </h5>
                  <button
                    type="button"
                    data-drawer-hide="drawer-example"
                    aria-controls="drawer-example"
                    (click)="closeDrawer()"
                    class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 absolute top-2.5 end-2.5 flex items-center justify-center dark:hover:bg-gray-600 dark:hover:text-white"
                  >
                    <svg
                      class="w-3 h-3"
                      aria-hidden="true"
                      xmlns="http://www.w3.org/2000/svg"
                      fill="none"
                      viewBox="0 0 14 14"
                    >
                      <path
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"
                      />
                    </svg>
                    <span class="sr-only">Close menu</span>
                  </button>

                  <div
                    class="py-5 px-2 mb-4 border border-gray-100 rounded-lg bg-gray-50 dark:bg-gray-800 dark:border-gray-700"
                  >
                    <ol class="divide-y divider-gray-200 dark:divide-gray-700">
                      <li
                        class="py-3 w-full"
                        *ngFor="let student of reportDetail.student_details"
                      >
                        <div class="flex items-center w-full">
                          <div class="flex-1 min-w-0 ms-4">
                            <p
                              class="text-sm font-medium text-gray-900 truncate capitalize"
                            >
                              {{ student.first_name }}
                              {{ student.last_name }}
                              <span class="lowercase"
                                >registered to your event</span
                              >
                            </p>
                            <p class="text-xs text-gray-500 truncate">
                              {{ student.course }} {{ student.year_level }} |
                              {{ student.block }}
                            </p>
                          </div>
                          <span
                            class="inline-flex items-center justify-center px-2 py-0.5 ms-3 text-xs font-medium text-gray-500 bg-gray-200 rounded"
                          >
                            @if(student.attendance_status === 'present'){
                            <span class="text-green-600 capitalize">{{
                              student.attendance_status
                            }}</span>

                            }@else {
                            <span class="text-red-600 capitalize">{{
                              student.attendance_status
                            }}</span>
                            }
                          </span>
                        </div>
                      </li>
                    </ol>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>
